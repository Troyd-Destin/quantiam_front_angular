!function(t){var r={};function e(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=r,e.d=function(t,r,s){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(s,o,function(r){return t[r]}.bind(null,o));return s},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=2)}([function(t,r,e){"use strict";const s=Object.prototype.toString;t.exports=function(t){return s.call(t).endsWith("Array]")}},function(t,r,e){"use strict";var s=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},h=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var r,e=s.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&s.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;for(r in t);return void 0===r||s.call(t,r)},u=function(t,r){i&&"__proto__"===r.name?i(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},l=function(t,r){if("__proto__"===r){if(!s.call(t,r))return;if(n)return n(t,r).value}return t[r]};t.exports=function t(){var r,e,s,o,i,n,f=arguments[0],c=1,m=arguments.length,w=!1;for("boolean"==typeof f&&(w=f,f=arguments[1]||{},c=2),(null==f||"object"!=typeof f&&"function"!=typeof f)&&(f={});c<m;++c)if(null!=(r=arguments[c]))for(e in r)s=l(f,e),f!==(o=l(r,e))&&(w&&o&&(h(o)||(i=a(o)))?(i?(i=!1,n=s&&a(s)?s:[]):n=s&&h(s)?s:{},u(f,{name:e,newValue:t(w,n,o)})):void 0!==o&&u(f,{name:e,newValue:o}));return f}},function(t,r,e){"use strict";var s=e(4),o=s.Matrix,i=s.inverse,n=e(3),a=e(1),h={windowSize:5,derivative:1,polynomial:2,pad:"none",padValue:"replicate"};t.exports=function(t,r,e){if((e=a({},h,e)).windowSize%2==0||e.windowSize<5||!Number.isInteger(e.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(e.derivative<0||!Number.isInteger(e.derivative))throw new RangeError("Derivative should be a positive integer");if(e.polynomial<1||!Number.isInteger(e.polynomial))throw new RangeError("Polynomial should be a positive integer");var s,u,l=Math.floor(e.windowSize/2);"pre"===e.pad&&(t=n(t,{size:l,value:e.padValue}));var f=new Array(t.length-2*l);if(5!==e.windowSize||2!==e.polynomial||1!==e.derivative&&2!==e.derivative){for(var c=o.ones(e.windowSize,e.polynomial+1),m=-(e.windowSize-1)/2,w=0;w<c.length;w++)for(var g=0;g<c[w].length;g++)m+1===0&&0===g||(c[w][g]=Math.pow(m+w,g));var v=c.transposeView();s=(s=i(v.mmul(c)).mmul(v))[e.derivative],u=1}else 1===e.derivative?(s=[-2,-1,0,1,2],u=10):(s=[2,-1,-2,-1,2],u=7);for(var d=u*Math.pow(r,e.derivative),p=l;p<t.length-l;p++){for(var b=0,M=0;M<s.length;M++)b+=s[M]*t[M+p-l]/d;f[p-l]=b}return"post"===e.pad&&(f=n(f,{size:l,value:e.padValue})),f}},function(t,r,e){"use strict";var s=e(1),o={size:1,value:0};t.exports=function(t,r){if(r=s({},o,r),Array.isArray(t))return Array.isArray(t[0])?function(t,r){throw t.length,t[0].length,void 0===r.size[0]&&(r.size=[r.size,r.size,r.size,r.size]),new Error("matrix not supported yet, sorry")}(t,r):function(t,r){var e=t.length;"number"==typeof r.size&&(r.size=[r.size,r.size]);var s,o,i=e+r.size[0]+r.size[1];if(r.output){if(r.output.length!==i)throw new RangeError("Wrong output size");s=r.output}else s=new Array(i);if("circular"===r.value)for(o=0;o<i;o++)o<r.size[0]?s[o]=t[(e-r.size[0]%e+o)%e]:o<r.size[0]+e?s[o]=t[o-r.size[0]]:s[o]=t[(o-r.size[0])%e];else if("replicate"===r.value)for(o=0;o<i;o++)o<r.size[0]?s[o]=t[0]:o<r.size[0]+e?s[o]=t[o-r.size[0]]:s[o]=t[e-1];else if("symmetric"===r.value){if(r.size[0]>e||r.size[1]>e)throw new RangeError("expanded value should not be bigger than the data length");for(o=0;o<i;o++)o<r.size[0]?s[o]=t[r.size[0]-1-o]:o<r.size[0]+e?s[o]=t[o-r.size[0]]:s[o]=t[2*e+r.size[0]-o-1]}else for(o=0;o<i;o++)o<r.size[0]?s[o]=r.value:o<r.size[0]+e?s[o]=t[o-r.size[0]]:s[o]=r.value;return s}(t,r);throw new TypeError("data should be an array")}},function(t,r,e){"use strict";e.r(r);var s=e(0),o=e.n(s);var i=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]>r&&(r=t[e]);return r};var n=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]<r&&(r=t[e]);return r};var a=function(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==e.output){if(!o()(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);var s=n(t),a=i(t);if(s===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=e.min,u=void 0===h?e.autoMinMax?s:0:h,l=e.max,f=void 0===l?e.autoMinMax?a:1:l;if(u>=f)throw new RangeError("min option must be smaller than max option");for(var c=(f-u)/(a-s),m=0;m<t.length;m++)r[m]=(t[m]-s)*c+u;return r};class h{constructor(t){var r,e,s,o,i,n,a,h,u,l=(t=N.checkMatrix(t)).clone(),f=l.rows,c=l.columns,m=new Array(f),w=1;for(r=0;r<f;r++)m[r]=r;for(h=new Array(f),e=0;e<c;e++){for(r=0;r<f;r++)h[r]=l.get(r,e);for(r=0;r<f;r++){for(u=Math.min(r,e),i=0,s=0;s<u;s++)i+=l.get(r,s)*h[s];h[r]-=i,l.set(r,e,h[r])}for(o=e,r=e+1;r<f;r++)Math.abs(h[r])>Math.abs(h[o])&&(o=r);if(o!==e){for(s=0;s<c;s++)n=l.get(o,s),l.set(o,s,l.get(e,s)),l.set(e,s,n);a=m[o],m[o]=m[e],m[e]=a,w=-w}if(e<f&&0!==l.get(e,e))for(r=e+1;r<f;r++)l.set(r,e,l.get(r,e)/l.get(e,e))}this.LU=l,this.pivotVector=m,this.pivotSign=w}isSingular(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1}solve(t){t=C.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,s,o,i=t.columns,n=t.subMatrixRow(this.pivotVector,0,i-1),a=r.columns;for(o=0;o<a;o++)for(e=o+1;e<a;e++)for(s=0;s<i;s++)n[e][s]-=n[o][s]*r[e][o];for(o=a-1;o>=0;o--){for(s=0;s<i;s++)n[o][s]/=r[o][o];for(e=0;e<o;e++)for(s=0;s<i;s++)n[e][s]-=n[o][s]*r[e][o]}return n}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,s=0;s<e;s++)r*=t[s][s];return r}get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new C(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)s[o][i]=o>i?t[o][i]:o===i?1:0;return s}get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new C(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)s[o][i]=o<=i?t[o][i]:0;return s}get pivotPermutationVector(){return this.pivotVector.slice()}}function u(t,r){var e=0;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}function l(t,r,e){for(var s=new Array(t),o=0;o<t;o++){s[o]=new Array(r);for(var i=0;i<r;i++)s[o][i]=e}return s}class f{constructor(t,r={}){var e=(t=N.checkMatrix(t)).rows,s=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:n=!1}=r;var a,h=Boolean(o),f=Boolean(i),c=!1;if(e<s)if(n){e=(a=t.transpose()).rows,s=a.columns,c=!0;var m=h;h=f,f=m}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();var w=Math.min(e,s),g=Math.min(e+1,s),v=new Array(g),d=l(e,w,0),p=l(s,s,0),b=new Array(s),M=new Array(e),x=new Array(g);for(let t=0;t<g;t++)x[t]=t;var y=Math.min(e-1,s),S=Math.max(0,Math.min(s-2,e)),R=Math.max(y,S);for(let t=0;t<R;t++){if(t<y){v[t]=0;for(let r=t;r<e;r++)v[t]=u(v[t],a[r][t]);if(0!==v[t]){a[t][t]<0&&(v[t]=-v[t]);for(let r=t;r<e;r++)a[r][t]/=v[t];a[t][t]+=1}v[t]=-v[t]}for(let r=t+1;r<s;r++){if(t<y&&0!==v[t]){let s=0;for(let o=t;o<e;o++)s+=a[o][t]*a[o][r];s=-s/a[t][t];for(let o=t;o<e;o++)a[o][r]+=s*a[o][t]}b[r]=a[t][r]}if(h&&t<y)for(let r=t;r<e;r++)d[r][t]=a[r][t];if(t<S){b[t]=0;for(let r=t+1;r<s;r++)b[t]=u(b[t],b[r]);if(0!==b[t]){b[t+1]<0&&(b[t]=0-b[t]);for(let r=t+1;r<s;r++)b[r]/=b[t];b[t+1]+=1}if(b[t]=-b[t],t+1<e&&0!==b[t]){for(let r=t+1;r<e;r++)M[r]=0;for(let r=t+1;r<e;r++)for(let e=t+1;e<s;e++)M[r]+=b[e]*a[r][e];for(let r=t+1;r<s;r++){let s=-b[r]/b[t+1];for(let o=t+1;o<e;o++)a[o][r]+=s*M[o]}}if(f)for(let r=t+1;r<s;r++)p[r][t]=b[r]}}let E=Math.min(s,e+1);if(y<s&&(v[y]=a[y][y]),e<E&&(v[E-1]=0),S+1<E&&(b[S]=a[S][E-1]),b[E-1]=0,h){for(let t=y;t<w;t++){for(let r=0;r<e;r++)d[r][t]=0;d[t][t]=1}for(let t=y-1;t>=0;t--)if(0!==v[t]){for(let r=t+1;r<w;r++){let s=0;for(let o=t;o<e;o++)s+=d[o][t]*d[o][r];s=-s/d[t][t];for(let o=t;o<e;o++)d[o][r]+=s*d[o][t]}for(let r=t;r<e;r++)d[r][t]=-d[r][t];d[t][t]=1+d[t][t];for(let r=0;r<t-1;r++)d[r][t]=0}else{for(let r=0;r<e;r++)d[r][t]=0;d[t][t]=1}}if(f)for(let t=s-1;t>=0;t--){if(t<S&&0!==b[t])for(let r=t+1;r<s;r++){let e=0;for(let o=t+1;o<s;o++)e+=p[o][t]*p[o][r];e=-e/p[t+1][t];for(let o=t+1;o<s;o++)p[o][r]+=e*p[o][t]}for(let r=0;r<s;r++)p[r][t]=0;p[t][t]=1}for(var V=E-1,A=Number.EPSILON;E>0;){let t,r;for(t=E-2;t>=-1&&-1!==t;t--){const r=Number.MIN_VALUE+A*Math.abs(v[t]+Math.abs(v[t+1]));if(Math.abs(b[t])<=r||Number.isNaN(b[t])){b[t]=0;break}}if(t===E-2)r=4;else{let e;for(e=E-1;e>=t&&e!==t;e--){let r=(e!==E?Math.abs(b[e]):0)+(e!==t+1?Math.abs(b[e-1]):0);if(Math.abs(v[e])<=A*r){v[e]=0;break}}e===t?r=3:e===E-1?r=1:(r=2,t=e)}switch(t++,r){case 1:{let r=b[E-2];b[E-2]=0;for(let e=E-2;e>=t;e--){let o=u(v[e],r),i=v[e]/o,n=r/o;if(v[e]=o,e!==t&&(r=-n*b[e-1],b[e-1]=i*b[e-1]),f)for(let t=0;t<s;t++)o=i*p[t][e]+n*p[t][E-1],p[t][E-1]=-n*p[t][e]+i*p[t][E-1],p[t][e]=o}break}case 2:{let r=b[t-1];b[t-1]=0;for(let s=t;s<E;s++){let o=u(v[s],r),i=v[s]/o,n=r/o;if(v[s]=o,r=-n*b[s],b[s]=i*b[s],h)for(let r=0;r<e;r++)o=i*d[r][s]+n*d[r][t-1],d[r][t-1]=-n*d[r][s]+i*d[r][t-1],d[r][s]=o}break}case 3:{const r=Math.max(Math.abs(v[E-1]),Math.abs(v[E-2]),Math.abs(b[E-2]),Math.abs(v[t]),Math.abs(b[t])),o=v[E-1]/r,i=v[E-2]/r,n=b[E-2]/r,a=v[t]/r,l=b[t]/r,c=((i+o)*(i-o)+n*n)/2,m=o*n*(o*n);let w=0;0===c&&0===m||(w=m/(c+(w=c<0?0-Math.sqrt(c*c+m):Math.sqrt(c*c+m))));let g=(a+o)*(a-o)+w,M=a*l;for(let r=t;r<E-1;r++){let o=u(g,M);0===o&&(o=Number.MIN_VALUE);let i=g/o,n=M/o;if(r!==t&&(b[r-1]=o),g=i*v[r]+n*b[r],b[r]=i*b[r]-n*v[r],M=n*v[r+1],v[r+1]=i*v[r+1],f)for(let t=0;t<s;t++)o=i*p[t][r]+n*p[t][r+1],p[t][r+1]=-n*p[t][r]+i*p[t][r+1],p[t][r]=o;if(0===(o=u(g,M))&&(o=Number.MIN_VALUE),i=g/o,n=M/o,v[r]=o,g=i*b[r]+n*v[r+1],v[r+1]=-n*b[r]+i*v[r+1],M=n*b[r+1],b[r+1]=i*b[r+1],h&&r<e-1)for(let t=0;t<e;t++)o=i*d[t][r]+n*d[t][r+1],d[t][r+1]=-n*d[t][r]+i*d[t][r+1],d[t][r]=o}b[E-2]=g,1;break}case 4:if(v[t]<=0&&(v[t]=v[t]<0?-v[t]:0,f))for(let r=0;r<=V;r++)p[r][t]=-p[r][t];for(;t<V&&!(v[t]>=v[t+1]);){let r=v[t];if(v[t]=v[t+1],v[t+1]=r,f&&t<s-1)for(let e=0;e<s;e++)r=p[e][t+1],p[e][t+1]=p[e][t],p[e][t]=r;if(h&&t<e-1)for(let s=0;s<e;s++)r=d[s][t+1],d[s][t+1]=d[s][t],d[s][t]=r;t++}0,E--}}if(c){var z=p;p=d,d=z}this.m=e,this.n=s,this.s=v,this.U=d,this.V=p}solve(t){var r=t,e=this.threshold,s=this.s.length,o=C.zeros(s,s);for(let t=0;t<s;t++)Math.abs(this.s[t])<=e?o[t][t]=0:o[t][t]=1/this.s[t];var i=this.U,n=this.rightSingularVectors,a=n.mmul(o),h=n.rows,u=i.length,l=C.zeros(h,u);for(let t=0;t<h;t++)for(let r=0;r<u;r++){let e=0;for(let o=0;o<s;o++)e+=a[t][o]*i[r][o];l[t][r]=e}return l.mmul(r)}solveForDiagonal(t){return this.solve(C.diag(t))}inverse(){var t=this.V,r=this.threshold,e=t.length,s=t[0].length,o=new C(e,this.s.length);for(let i=0;i<e;i++)for(let e=0;e<s;e++)Math.abs(this.s[e])>r?o[i][e]=t[i][e]/this.s[e]:o[i][e]=0;var i=this.U,n=i.length,a=i[0].length,h=new C(e,n);for(let t=0;t<e;t++)for(let r=0;r<n;r++){let e=0;for(let s=0;s<a;s++)e+=o[t][s]*i[r][s];h[t][r]=e}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s,s=0,o=e.length;s<o;s++)e[s]>t&&r++;return r}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return C.isMatrix(this.U)||(this.U=new C(this.U)),this.U}get rightSingularVectors(){return C.isMatrix(this.V)||(this.V=new C(this.V)),this.V}get diagonalMatrix(){return C.diag(this.s)}}function c(t,r,e){var s=e?t.rows:t.rows-1;if(r<0||r>s)throw new RangeError("Row index out of range")}function m(t,r,e){var s=e?t.columns:t.columns-1;if(r<0||r>s)throw new RangeError("Column index out of range")}function w(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function g(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function v(t,r,e){return{row:d(t,r),column:p(t,e)}}function d(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for row indices");if(r.some(r=>r<0||r>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function p(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for column indices");if(r.some(r=>r<0||r>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function b(t,r,e,s,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(M("startRow",r),M("endRow",e),M("startColumn",s),M("endColumn",o),r>e||s>o||r<0||r>=t.rows||e<0||e>=t.rows||s<0||s>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function M(t,r){if("number"!=typeof r)throw new TypeError(`${t} must be a number`)}class x extends(k()){constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}static get[Symbol.species](){return C}}class y extends x{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}class S extends x{constructor(t,r){super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}class R extends x{constructor(t,r,e,s,o){b(t,r,e,s,o),super(t,e-r+1,o-s+1),this.startRow=r,this.startColumn=s}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}class E extends x{constructor(t,r,e){var s=v(t,r,e);super(t,s.row.length,s.column.length),this.rowIndices=s.row,this.columnIndices=s.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}class V extends x{constructor(t,r){super(t,(r=d(t,r)).length,t.columns),this.rowIndices=r}set(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}get(t,r){return this.matrix.get(this.rowIndices[t],r)}}class A extends x{constructor(t,r){r=p(t,r),super(t,t.rows,r.length),this.columnIndices=r}set(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}get(t,r){return this.matrix.get(t,this.columnIndices[r])}}class z extends x{constructor(t,r){super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}class j extends x{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}class I extends x{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}function k(t){void 0===t&&(t=Object);class r extends t{static get[Symbol.species](){return this}static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var s=new this(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)s.set(o,i,e[o*r+i]);return s}static rowVector(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static empty(t,r){return new this(t,r)}static zeros(t,r){return this.empty(t,r).fill(0)}static ones(t,r){return this.empty(t,r).fill(1)}static rand(t,r,e){void 0===e&&(e=Math.random);for(var s=this.empty(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)s.set(o,i,e());return s}static randInt(t,r,e,s){void 0===e&&(e=1e3),void 0===s&&(s=Math.random);for(var o=this.empty(t,r),i=0;i<t;i++)for(var n=0;n<r;n++){var a=Math.floor(s()*e);o.set(i,n,a)}return o}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var s=Math.min(t,r),o=this.zeros(t,r),i=0;i<s;i++)o.set(i,i,e);return o}static diag(t,r,e){var s=t.length;void 0===r&&(r=s),void 0===e&&(e=r);for(var o=Math.min(s,r,e),i=this.zeros(r,e),n=0;n<o;n++)i.set(n,n,t[n]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new this(e,s),i=0;i<e;i++)for(var n=0;n<s;n++)o.set(i,n,Math.min(t.get(i,n),r.get(i,n)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new this(e,s),i=0;i<e;i++)for(var n=0;n<s;n++)o.set(i,n,Math.max(t.get(i,n),r.get(i,n)));return o}static checkMatrix(t){return r.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,s=0;s<r;s++)for(var o=0;o<e;o++)t.call(this,s,o);return this}to1DArray(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}to2DArray(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),s=0;s<t;s++)for(var o=0;o<r;o++)e.setSubMatrix(this,this.rows*s,this.columns*o);return e}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,r){c(this,t),r=w(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){c(this,t),c(this,r);for(var e=0;e<this.columns;e++){var s=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,s)}return this}getColumn(t){m(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,r){m(this,t),r=g(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){m(this,t),m(this,r);for(var e=0;e<this.rows;e++){var s=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,s)}return this}addRowVector(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){c(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){m(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)>t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)<t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}maxRow(t){c(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){c(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)>r&&(r=this.get(t,s),e[1]=s);return e}minRow(t){c(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){c(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)<r&&(r=this.get(t,s),e[1]=s);return e}maxColumn(t){m(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){m(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)>r&&(r=this.get(s,t),e[0]=s);return e}minColumn(t){m(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){m(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)<r&&(r=this.get(s,t),e[0]=s);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}sum(t){switch(t){case"row":return function(t){for(var r=C.zeros(t.rows,1),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r.set(e,0,r.get(e,0)+t.get(e,s));return r}(this);case"column":return function(t){for(var r=C.zeros(1,t.columns),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r.set(0,s,r.get(0,s)+t.get(e,s));return r}(this);default:return function(t){for(var r=0,e=0;e<t.rows;e++)for(var s=0;s<t.columns;s++)r+=t.get(e,s);return r}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}norm(t="frobenius"){var r=0;if("max"===t)return this.max();if("frobenius"===t){for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)r+=this.get(e,s)*this.get(e,s);return Math.sqrt(r)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){r.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var s=0,o=0;o<e.length;o++)s+=e[o]*t[o];return s}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,s=t.columns,o=new this.constructor[Symbol.species](r,s),i=new Array(e),n=0;n<s;n++){for(var a=0;a<e;a++)i[a]=t.get(a,n);for(var h=0;h<r;h++){var u=0;for(a=0;a<e;a++)u+=this.get(h,a)*i[a];o.set(h,n,u)}}return o}strassen2x2(t){var r=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),s=t.get(0,0),o=this.get(0,1),i=t.get(0,1),n=this.get(1,0),a=t.get(1,0),h=this.get(1,1),u=t.get(1,1),l=(e+h)*(s+u),f=(n+h)*s,c=e*(i-u),m=h*(a-s),w=(e+o)*u,g=l+m-w+(o-h)*(a+u),v=c+w,d=f+m,p=l-f+c+(n-e)*(s+i);return r.set(0,0,g),r.set(0,1,v),r.set(1,0,d),r.set(1,1,p),r}strassen3x3(t){var r=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),s=this.get(0,1),o=this.get(0,2),i=this.get(1,0),n=this.get(1,1),a=this.get(1,2),h=this.get(2,0),u=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),w=t.get(1,0),g=t.get(1,1),v=t.get(1,2),d=t.get(2,0),p=t.get(2,1),b=t.get(2,2),M=(e-i)*(-c+g),x=(-e+i+n)*(f-c+g),y=(i+n)*(-f+c),S=e*f,R=(-e+h+u)*(f-m+v),E=(-e+h)*(m-v),V=(h+u)*(-f+m),A=(-o+u+l)*(g+d-p),z=(o-l)*(g-p),j=o*d,I=(u+l)*(-d+p),k=(-o+n+a)*(v+d-b),C=(o-a)*(v-b),D=(n+a)*(-d+b),N=S+j+s*w,q=(e+s+o-i-n-u-l)*g+x+y+S+A+j+I,O=S+R+V+(e+s+o-n-a-h-u)*v+j+k+D,T=M+n*(-f+c+w-g-v-d+b)+x+S+j+k+C,L=M+x+y+S+a*p,P=j+k+C+D+i*m,_=S+R+E+u*(-f+m+w-g-v-d+p)+A+z+j,U=A+z+j+I+h*c,$=S+R+E+V+l*b;return r.set(0,0,N),r.set(0,1,q),r.set(0,2,O),r.set(1,0,T),r.set(1,1,L),r.set(1,2,P),r.set(2,0,_),r.set(2,1,U),r.set(2,2,$),r}mmulStrassen(t){var e=this.clone(),s=e.rows,o=e.columns,i=t.rows,n=t.columns;function a(t,e,s){var o=t.rows,i=t.columns;if(o===e&&i===s)return t;var n=r.zeros(e,s);return n=n.setSubMatrix(t,0,0)}o!==i&&console.warn(`Multiplying ${s} x ${o} and ${i} x ${n} matrix: dimensions do not match.`);var h=Math.max(s,i),u=Math.max(o,n);return function t(e,s,o,i){if(o<=512||i<=512)return e.mmul(s);o%2==1&&i%2==1?(e=a(e,o+1,i+1),s=a(s,o+1,i+1)):o%2==1?(e=a(e,o+1,i),s=a(s,o+1,i)):i%2==1&&(e=a(e,o,i+1),s=a(s,o,i+1));var n=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),u=e.subMatrix(0,n-1,0,h-1),l=s.subMatrix(0,n-1,0,h-1),f=e.subMatrix(0,n-1,h,e.columns-1),c=s.subMatrix(0,n-1,h,s.columns-1),m=e.subMatrix(n,e.rows-1,0,h-1),w=s.subMatrix(n,s.rows-1,0,h-1),g=e.subMatrix(n,e.rows-1,h,e.columns-1),v=s.subMatrix(n,s.rows-1,h,s.columns-1),d=t(r.add(u,g),r.add(l,v),n,h),p=t(r.add(m,g),l,n,h),b=t(u,r.sub(c,v),n,h),M=t(g,r.sub(w,l),n,h),x=t(r.add(u,f),v,n,h),y=t(r.sub(m,u),r.add(l,c),n,h),S=t(r.sub(f,g),r.add(w,v),n,h),R=r.add(d,M);R.sub(x),R.add(S);var E=r.add(b,x),V=r.add(p,M),A=r.sub(d,p);A.add(b),A.add(y);var z=r.zeros(2*R.rows,2*R.columns);return(z=(z=(z=(z=z.setSubMatrix(R,0,0)).setSubMatrix(E,R.rows,0)).setSubMatrix(V,0,R.columns)).setSubMatrix(A,R.rows,R.columns)).subMatrix(0,o-1,0,i-1)}(e=a(e,h,u),t=a(t,h,u),h,u)}scaleRows(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),s=0;s<this.rows;s++){var o=a(this.getRow(s),{min:t,max:r});e.setRow(s,o)}return e}scaleColumns(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),s=0;s<this.columns;s++){var o=a(this.getColumn(s),{min:t,max:r});e.setColumn(s,o)}return e}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,s=t.rows,o=t.columns,i=new this.constructor[Symbol.species](r*s,e*o),n=0;n<r;n++)for(var a=0;a<e;a++)for(var h=0;h<s;h++)for(var u=0;u<o;u++)i[s*n+h][o*a+u]=this.get(n,a)*t.get(h,u);return i}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t){void 0===t&&(t=e);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t){void 0===t&&(t=e);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,s){b(this,t,r,e,s);for(var o=new this.constructor[Symbol.species](r-t+1,s-e+1),i=t;i<=r;i++)for(var n=e;n<=s;n++)o[i-t][n-e]=this.get(i,n);return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var s=new this.constructor[Symbol.species](t.length,e-r+1),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);s.set(o,i-r,this.get(t[o],i))}return s}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var s=new this.constructor[Symbol.species](e-r+1,t.length),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);s.set(i-r,o,this.get(i,t[o]))}return s}setSubMatrix(t,r,e){b(this,r,r+(t=this.constructor.checkMatrix(t)).rows-1,e,e+t.columns-1);for(var s=0;s<t.rows;s++)for(var o=0;o<t.columns;o++)this[r+s][e+o]=t.get(s,o);return this}selection(t,r){for(var e=v(this,t,r),s=new this.constructor[Symbol.species](t.length,r.length),o=0;o<e.row.length;o++)for(var i=e.row[o],n=0;n<e.column.length;n++){var a=e.column[n];s[o][n]=this.get(i,a)}return s}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}transposeView(){return new y(this)}rowView(t){return c(this,t),new S(this,t)}columnView(t){return m(this,t),new z(this,t)}flipRowView(){return new j(this)}flipColumnView(){return new I(this)}subMatrixView(t,r,e,s){return new R(this,t,r,e,s)}selectionView(t,r){return new E(this,t,r)}rowSelectionView(t){return new V(this,t)}columnSelectionView(t){return new A(this,t)}det(){var t,r,e,s,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(s=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*s.det()-r*o.det()+e*i.det()):new h(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var r=new f(this,{autoTranspose:!0}),e=r.leftSingularVectors,s=r.rightSingularVectors,o=r.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),s.mmul(o.mmul(e.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}}function e(t,r){return t-r}r.prototype.klass="Matrix",r.random=r.rand,r.diagonal=r.diag,r.prototype.diagonal=r.prototype.diag,r.identity=r.eye,r.prototype.negate=r.prototype.neg,r.prototype.tensorProduct=r.prototype.kroneckerProduct,r.prototype.determinant=r.prototype.det;var s,o="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",i=eval;for(var n of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var u=i(Q("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:n[1],op:n[0]})),l=i(Q("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${n[1]}S`,op:n[0]})),d=i(Q("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${n[1]}M`,op:n[0]})),p=i(Q("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:n[1]}));for(s=1;s<n.length;s++)r.prototype[n[s]]=u,r.prototype[`${n[s]}S`]=l,r.prototype[`${n[s]}M`]=d,r[n[s]]=p}var M=[["~","not"]];for(var x of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){M.push([`Math.${t}`,t])}),M)){var k=i(Q("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:x[1],method:x[0]})),D=i(Q("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:x[1]}));for(s=1;s<x.length;s++)r.prototype[x[s]]=k,r[x[s]]=D}for(var N of[["Math.pow",1,"pow"]]){var q="arg0";for(s=1;s<N[1];s++)q+=`, arg${s}`;if(1!==N[1]){var O=i(Q("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:N[2],method:N[0],args:q})),T=i(Q(o,{name:N[2],args:q}));for(s=2;s<N.length;s++)r.prototype[N[s]]=O,r[N[s]]=T}else{var L={name:N[2],args:q,method:N[0]},P=i(Q("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",L)),_=i(Q("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",L)),U=i(Q("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",L)),$=i(Q("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",L));for(s=2;s<N.length;s++)r.prototype[N[s]]=P,r.prototype[`${N[s]}M`]=U,r.prototype[`${N[s]}S`]=_,r[N[s]]=$}}function Q(t,r){for(var e in r)t=t.replace(new RegExp(`%${e}%`,"g"),r[e]);return t}return r}class C extends(k(Array)){constructor(t,r){var e;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(C.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<t;e++)this[e]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const s=t;if(t=s.length,"number"!=typeof(r=s[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),e=0;e<t;e++){if(s[e].length!==r)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(s[e])}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this[t][r]=e,this}get(t,r){return this[t][r]}removeRow(t){if(c(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),c(this,t,!0),r=w(this,r),this.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(m(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),m(this,t,!0),r=g(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}class D extends(k()){constructor(t,r={}){const{rows:e=1}=r;if(t.length%e!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=e,this.columns=t.length/e,this.data=t}set(t,r,e){var s=this._calculateIndex(t,r);return this.data[s]=e,this}get(t,r){var e=this._calculateIndex(t,r);return this.data[e]}_calculateIndex(t,r){return t*this.columns+r}static get[Symbol.species](){return C}}class N extends(k()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}static get[Symbol.species](){return C}}function q(t,r){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new N(t):new D(t,r);throw new Error("the argument is not an array")}class O{constructor(t){var r,e,s,o,i=(t=N.checkMatrix(t)).clone(),n=t.rows,a=t.columns,h=new Array(a);for(s=0;s<a;s++){var l=0;for(r=s;r<n;r++)l=u(l,i.get(r,s));if(0!==l){for(i.get(s,s)<0&&(l=-l),r=s;r<n;r++)i.set(r,s,i.get(r,s)/l);for(i.set(s,s,i.get(s,s)+1),e=s+1;e<a;e++){for(o=0,r=s;r<n;r++)o+=i.get(r,s)*i.get(r,e);for(o=-o/i.get(s,s),r=s;r<n;r++)i.set(r,e,i.get(r,e)+o*i.get(r,s))}}h[s]=-l}this.QR=i,this.Rdiag=h}solve(t){t=C.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var s,o,i,n,a=t.columns,h=t.clone(),u=r.columns;for(i=0;i<u;i++)for(o=0;o<a;o++){for(n=0,s=i;s<e;s++)n+=r[s][i]*h[s][o];for(n=-n/r[i][i],s=i;s<e;s++)h[s][o]+=n*r[s][i]}for(i=u-1;i>=0;i--){for(o=0;o<a;o++)h[i][o]/=this.Rdiag[i];for(s=0;s<i;s++)for(o=0;o<a;o++)h[s][o]-=h[i][o]*r[s][i]}return h.subMatrix(0,u-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0}get upperTriangularMatrix(){var t,r,e=this.QR,s=e.columns,o=new C(s,s);for(t=0;t<s;t++)for(r=0;r<s;r++)o[t][r]=t<r?e[t][r]:t===r?this.Rdiag[t]:0;return o}get orthogonalMatrix(){var t,r,e,s,o=this.QR,i=o.rows,n=o.columns,a=new C(i,n);for(e=n-1;e>=0;e--){for(t=0;t<i;t++)a[t][e]=0;for(a[e][e]=1,r=e;r<n;r++)if(0!==o[e][e]){for(s=0,t=e;t<i;t++)s+=o[t][e]*a[t][r];for(s=-s/o[e][e],t=e;t<i;t++)a[t][r]+=s*o[t][e]}}return a}}function T(t,r=!1){return t=N.checkMatrix(t),r?new f(t).inverse():L(t,C.eye(t.rows))}function L(t,r,e=!1){return t=N.checkMatrix(t),r=N.checkMatrix(r),e?new f(t).solve(r):t.isSquare()?new h(t).solve(r):new O(t).solve(r)}function P(t,r){for(var e=[],s=0;s<t;s++)s!==r&&e.push(s);return e}function _(t,r,e,s=1e-9,o=1e-9){if(t>o)return new Array(r.rows+1).fill(0);for(var i=r.addRow(e,[0]),n=0;n<i.rows;n++)Math.abs(i.get(n,0))<s&&i.set(n,0,0);return i.to1DArray()}function U(t,r={}){const{thresholdValue:e=1e-9,thresholdError:s=1e-9}=r;for(var o=t.rows,n=new C(o,o),a=0;a<o;a++){var h=C.columnVector(t.getRow(a)),u=t.subMatrixRow(P(o,a)).transposeView(),l=new f(u).solve(h),c=i(C.sub(h,u.mmul(l)).abs().to1DArray());n.setRow(a,_(c,l,a,e,s))}return n}class ${constructor(t,r={}){const{assumeSymmetric:e=!1}=r;if(!(t=N.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var s,o,i=t.columns,n=l(i,i,0),a=new Array(i),h=new Array(i),f=t;if(!!e||t.isSymmetric()){for(s=0;s<i;s++)for(o=0;o<i;o++)n[s][o]=f.get(s,o);!function(t,r,e,s){var o,i,n,a,h,u,l,f;for(h=0;h<t;h++)e[h]=s[t-1][h];for(a=t-1;a>0;a--){for(f=0,n=0,u=0;u<a;u++)f+=Math.abs(e[u]);if(0===f)for(r[a]=e[a-1],h=0;h<a;h++)e[h]=s[a-1][h],s[a][h]=0,s[h][a]=0;else{for(u=0;u<a;u++)e[u]/=f,n+=e[u]*e[u];for(o=e[a-1],i=Math.sqrt(n),o>0&&(i=-i),r[a]=f*i,n-=o*i,e[a-1]=o-i,h=0;h<a;h++)r[h]=0;for(h=0;h<a;h++){for(o=e[h],s[h][a]=o,i=r[h]+s[h][h]*o,u=h+1;u<=a-1;u++)i+=s[u][h]*e[u],r[u]+=s[u][h]*o;r[h]=i}for(o=0,h=0;h<a;h++)r[h]/=n,o+=r[h]*e[h];for(l=o/(n+n),h=0;h<a;h++)r[h]-=l*e[h];for(h=0;h<a;h++){for(o=e[h],i=r[h],u=h;u<=a-1;u++)s[u][h]-=o*r[u]+i*e[u];e[h]=s[a-1][h],s[a][h]=0}}e[a]=n}for(a=0;a<t-1;a++){if(s[t-1][a]=s[a][a],s[a][a]=1,0!==(n=e[a+1])){for(u=0;u<=a;u++)e[u]=s[u][a+1]/n;for(h=0;h<=a;h++){for(i=0,u=0;u<=a;u++)i+=s[u][a+1]*s[u][h];for(u=0;u<=a;u++)s[u][h]-=i*e[u]}}for(u=0;u<=a;u++)s[u][a+1]=0}for(h=0;h<t;h++)e[h]=s[t-1][h],s[t-1][h]=0;s[t-1][t-1]=1,r[0]=0}(i,h,a,n),function(t,r,e,s){var o,i,n,a,h,l,f,c,m,w,g,v,d,p,b,M;for(n=1;n<t;n++)r[n-1]=r[n];r[t-1]=0;var x=0,y=0,S=Number.EPSILON;for(l=0;l<t;l++){for(y=Math.max(y,Math.abs(e[l])+Math.abs(r[l])),f=l;f<t&&!(Math.abs(r[f])<=S*y);)f++;if(f>l){0;do{for(1,o=e[l],c=(e[l+1]-o)/(2*r[l]),m=u(c,1),c<0&&(m=-m),e[l]=r[l]/(c+m),e[l+1]=r[l]*(c+m),w=e[l+1],i=o-e[l],n=l+2;n<t;n++)e[n]-=i;for(x+=i,c=e[f],v=g=1,d=g,p=r[l+1],b=0,M=0,n=f-1;n>=l;n--)for(d=v,v=g,M=b,o=g*r[n],i=g*c,m=u(c,r[n]),r[n+1]=b*m,b=r[n]/m,c=(g=c/m)*e[n]-b*o,e[n+1]=i+b*(g*o+b*e[n]),h=0;h<t;h++)i=s[h][n+1],s[h][n+1]=b*s[h][n]+g*i,s[h][n]=g*s[h][n]-b*i;c=-b*M*d*p*r[l]/w,r[l]=b*c,e[l]=g*c}while(Math.abs(r[l])>S*y)}e[l]=e[l]+x,r[l]=0}for(n=0;n<t-1;n++){for(h=n,c=e[n],a=n+1;a<t;a++)e[a]<c&&(h=a,c=e[a]);if(h!==n)for(e[h]=e[n],e[n]=c,a=0;a<t;a++)c=s[a][n],s[a][n]=s[a][h],s[a][h]=c}}(i,h,a,n)}else{var c=l(i,i,0),m=new Array(i);for(o=0;o<i;o++)for(s=0;s<i;s++)c[s][o]=f.get(s,o);!function(t,r,e,s){var o,i,n,a,h,u,l,f=t-1;for(u=1;u<=f-1;u++){for(l=0,a=u;a<=f;a++)l+=Math.abs(r[a][u-1]);if(0!==l){for(n=0,a=f;a>=u;a--)e[a]=r[a][u-1]/l,n+=e[a]*e[a];for(i=Math.sqrt(n),e[u]>0&&(i=-i),n-=e[u]*i,e[u]=e[u]-i,h=u;h<t;h++){for(o=0,a=f;a>=u;a--)o+=e[a]*r[a][h];for(o/=n,a=u;a<=f;a++)r[a][h]-=o*e[a]}for(a=0;a<=f;a++){for(o=0,h=f;h>=u;h--)o+=e[h]*r[a][h];for(o/=n,h=u;h<=f;h++)r[a][h]-=o*e[h]}e[u]=l*e[u],r[u][u-1]=l*i}}for(a=0;a<t;a++)for(h=0;h<t;h++)s[a][h]=a===h?1:0;for(u=f-1;u>=1;u--)if(0!==r[u][u-1]){for(a=u+1;a<=f;a++)e[a]=r[a][u-1];for(h=u;h<=f;h++){for(i=0,a=u;a<=f;a++)i+=e[a]*s[a][h];for(i=i/e[u]/r[u][u-1],a=u;a<=f;a++)s[a][h]+=i*e[a]}}}(i,c,m,n),function(t,r,e,s,o){var i,n,a,h,u,l,f,c,m,w,g,v,d,p,b,M=t-1,x=t-1,y=Number.EPSILON,S=0,R=0,E=0,V=0,A=0,z=0,j=0,I=0;for(i=0;i<t;i++)for((i<0||i>x)&&(e[i]=o[i][i],r[i]=0),n=Math.max(i-1,0);n<t;n++)R+=Math.abs(o[i][n]);for(;M>=0;){for(h=M;h>0&&(0===(z=Math.abs(o[h-1][h-1])+Math.abs(o[h][h]))&&(z=R),!(Math.abs(o[h][h-1])<y*z));)h--;if(h===M)o[M][M]=o[M][M]+S,e[M]=o[M][M],r[M]=0,M--,I=0;else if(h===M-1){if(f=o[M][M-1]*o[M-1][M],E=(o[M-1][M-1]-o[M][M])/2,V=E*E+f,j=Math.sqrt(Math.abs(V)),o[M][M]=o[M][M]+S,o[M-1][M-1]=o[M-1][M-1]+S,c=o[M][M],V>=0){for(j=E>=0?E+j:E-j,e[M-1]=c+j,e[M]=e[M-1],0!==j&&(e[M]=c-f/j),r[M-1]=0,r[M]=0,c=o[M][M-1],z=Math.abs(c)+Math.abs(j),E=c/z,V=j/z,A=Math.sqrt(E*E+V*V),E/=A,V/=A,n=M-1;n<t;n++)j=o[M-1][n],o[M-1][n]=V*j+E*o[M][n],o[M][n]=V*o[M][n]-E*j;for(i=0;i<=M;i++)j=o[i][M-1],o[i][M-1]=V*j+E*o[i][M],o[i][M]=V*o[i][M]-E*j;for(i=0;i<=x;i++)j=s[i][M-1],s[i][M-1]=V*j+E*s[i][M],s[i][M]=V*s[i][M]-E*j}else e[M-1]=c+E,e[M]=c+E,r[M-1]=j,r[M]=-j;M-=2,I=0}else{if(c=o[M][M],m=0,f=0,h<M&&(m=o[M-1][M-1],f=o[M][M-1]*o[M-1][M]),10===I){for(S+=c,i=0;i<=M;i++)o[i][i]-=c;z=Math.abs(o[M][M-1])+Math.abs(o[M-1][M-2]),c=m=.75*z,f=-.4375*z*z}if(30===I&&(z=(z=(m-c)/2)*z+f)>0){for(z=Math.sqrt(z),m<c&&(z=-z),z=c-f/((m-c)/2+z),i=0;i<=M;i++)o[i][i]-=z;S+=z,c=m=f=.964}for(I+=1,u=M-2;u>=h&&(j=o[u][u],E=((A=c-j)*(z=m-j)-f)/o[u+1][u]+o[u][u+1],V=o[u+1][u+1]-j-A-z,A=o[u+2][u+1],z=Math.abs(E)+Math.abs(V)+Math.abs(A),E/=z,V/=z,A/=z,u!==h)&&!(Math.abs(o[u][u-1])*(Math.abs(V)+Math.abs(A))<y*(Math.abs(E)*(Math.abs(o[u-1][u-1])+Math.abs(j)+Math.abs(o[u+1][u+1]))));)u--;for(i=u+2;i<=M;i++)o[i][i-2]=0,i>u+2&&(o[i][i-3]=0);for(a=u;a<=M-1&&(p=a!==M-1,a!==u&&(E=o[a][a-1],V=o[a+1][a-1],A=p?o[a+2][a-1]:0,0!==(c=Math.abs(E)+Math.abs(V)+Math.abs(A))&&(E/=c,V/=c,A/=c)),0!==c);a++)if(z=Math.sqrt(E*E+V*V+A*A),E<0&&(z=-z),0!==z){for(a!==u?o[a][a-1]=-z*c:h!==u&&(o[a][a-1]=-o[a][a-1]),c=(E+=z)/z,m=V/z,j=A/z,V/=E,A/=E,n=a;n<t;n++)E=o[a][n]+V*o[a+1][n],p&&(E+=A*o[a+2][n],o[a+2][n]=o[a+2][n]-E*j),o[a][n]=o[a][n]-E*c,o[a+1][n]=o[a+1][n]-E*m;for(i=0;i<=Math.min(M,a+3);i++)E=c*o[i][a]+m*o[i][a+1],p&&(E+=j*o[i][a+2],o[i][a+2]=o[i][a+2]-E*A),o[i][a]=o[i][a]-E,o[i][a+1]=o[i][a+1]-E*V;for(i=0;i<=x;i++)E=c*s[i][a]+m*s[i][a+1],p&&(E+=j*s[i][a+2],s[i][a+2]=s[i][a+2]-E*A),s[i][a]=s[i][a]-E,s[i][a+1]=s[i][a+1]-E*V}}}if(0===R)return;for(M=t-1;M>=0;M--)if(E=e[M],0===(V=r[M]))for(h=M,o[M][M]=1,i=M-1;i>=0;i--){for(f=o[i][i]-E,A=0,n=h;n<=M;n++)A+=o[i][n]*o[n][M];if(r[i]<0)j=f,z=A;else if(h=i,0===r[i]?o[i][M]=0!==f?-A/f:-A/(y*R):(c=o[i][i+1],m=o[i+1][i],V=(e[i]-E)*(e[i]-E)+r[i]*r[i],l=(c*z-j*A)/V,o[i][M]=l,o[i+1][M]=Math.abs(c)>Math.abs(j)?(-A-f*l)/c:(-z-m*l)/j),l=Math.abs(o[i][M]),y*l*l>1)for(n=i;n<=M;n++)o[n][M]=o[n][M]/l}else if(V<0)for(h=M-1,Math.abs(o[M][M-1])>Math.abs(o[M-1][M])?(o[M-1][M-1]=V/o[M][M-1],o[M-1][M]=-(o[M][M]-E)/o[M][M-1]):(b=Q(0,-o[M-1][M],o[M-1][M-1]-E,V),o[M-1][M-1]=b[0],o[M-1][M]=b[1]),o[M][M-1]=0,o[M][M]=1,i=M-2;i>=0;i--){for(w=0,g=0,n=h;n<=M;n++)w+=o[i][n]*o[n][M-1],g+=o[i][n]*o[n][M];if(f=o[i][i]-E,r[i]<0)j=f,A=w,z=g;else if(h=i,0===r[i]?(b=Q(-w,-g,f,V),o[i][M-1]=b[0],o[i][M]=b[1]):(c=o[i][i+1],m=o[i+1][i],v=(e[i]-E)*(e[i]-E)+r[i]*r[i]-V*V,d=2*(e[i]-E)*V,0===v&&0===d&&(v=y*R*(Math.abs(f)+Math.abs(V)+Math.abs(c)+Math.abs(m)+Math.abs(j))),b=Q(c*A-j*w+V*g,c*z-j*g-V*w,v,d),o[i][M-1]=b[0],o[i][M]=b[1],Math.abs(c)>Math.abs(j)+Math.abs(V)?(o[i+1][M-1]=(-w-f*o[i][M-1]+V*o[i][M])/c,o[i+1][M]=(-g-f*o[i][M]-V*o[i][M-1])/c):(b=Q(-A-m*o[i][M-1],-z-m*o[i][M],j,V),o[i+1][M-1]=b[0],o[i+1][M]=b[1])),l=Math.max(Math.abs(o[i][M-1]),Math.abs(o[i][M])),y*l*l>1)for(n=i;n<=M;n++)o[n][M-1]=o[n][M-1]/l,o[n][M]=o[n][M]/l}for(i=0;i<t;i++)if(i<0||i>x)for(n=i;n<t;n++)s[i][n]=o[i][n];for(n=t-1;n>=0;n--)for(i=0;i<=x;i++){for(j=0,a=0;a<=Math.min(n,x);a++)j+=s[i][a]*o[a][n];s[i][n]=j}}(i,h,a,n,c)}this.n=i,this.e=h,this.d=a,this.V=n}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return C.isMatrix(this.V)||(this.V=new C(this.V)),this.V}get diagonalMatrix(){var t,r,e=this.n,s=this.e,o=this.d,i=new C(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)i[t][r]=0;i[t][t]=o[t],s[t]>0?i[t][t+1]=s[t]:s[t]<0&&(i[t][t-1]=s[t])}return i}}function Q(t,r,e,s){var o,i;return Math.abs(e)>Math.abs(s)?[(t+(o=s/e)*r)/(i=e+o*s),(r-o*t)/i]:[((o=e/s)*t+r)/(i=s+o*e),(o*r-t)/i]}class F{constructor(t){if(!(t=N.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var r,e,s,o=t,i=o.rows,n=new C(i,i),a=!0;for(e=0;e<i;e++){var h=n[e],u=0;for(s=0;s<e;s++){var l=n[s],f=0;for(r=0;r<s;r++)f+=l[r]*h[r];h[s]=f=(o.get(e,s)-f)/n[s][s],u+=f*f}for(a&=(u=o.get(e,e)-u)>0,n[e][e]=Math.sqrt(Math.max(u,0)),s=e+1;s<i;s++)n[e][s]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=n}solve(t){t=N.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var s,o,i,n=t.columns,a=t.clone();for(i=0;i<e;i++)for(o=0;o<n;o++){for(s=0;s<i;s++)a[i][o]-=a[s][o]*r[i][s];a[i][o]/=r[i][i]}for(i=e-1;i>=0;i--)for(o=0;o<n;o++){for(s=i+1;s<e;s++)a[i][o]-=a[s][o]*r[s][i];a[i][o]/=r[i][i]}return a}get lowerTriangularMatrix(){return this.L}}e.d(r,"default",function(){return C}),e.d(r,"Matrix",function(){return C}),e.d(r,"abstractMatrix",function(){return k}),e.d(r,"wrap",function(){return q}),e.d(r,"WrapperMatrix2D",function(){return N}),e.d(r,"WrapperMatrix1D",function(){return D}),e.d(r,"solve",function(){return L}),e.d(r,"inverse",function(){return T}),e.d(r,"linearDependencies",function(){return U}),e.d(r,"SingularValueDecomposition",function(){return f}),e.d(r,"SVD",function(){return f}),e.d(r,"EigenvalueDecomposition",function(){return $}),e.d(r,"EVD",function(){return $}),e.d(r,"CholeskyDecomposition",function(){return F}),e.d(r,"CHO",function(){return F}),e.d(r,"LuDecomposition",function(){return h}),e.d(r,"LU",function(){return h}),e.d(r,"QrDecomposition",function(){return O}),e.d(r,"QR",function(){return O})}]);